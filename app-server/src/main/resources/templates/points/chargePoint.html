<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>포인트 충전 및 입찰</title>
    <!-- 아임포트 라이브러리 추가 -->
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script type="text/javascript" src="https://cdn.iamport.kr/js/iamport.payment-1.2.0.js"></script>
    <script src="/js/historyAPI.js" defer></script>
</head>
<body>
<div data-th-replace="header :: header"></div>

<h2>마이페이지</h2>

<img data-th-if="${session.loginUser.profilePhoto == null}" style='height:40px' src='/images/avatar.png'>
<img data-th-if="${session.loginUser.profilePhoto != null}"
     data-th-src="${'http://tyasnlztlptw19619311.cdn.ntruss.com/member/' + session.loginUser.profilePhoto + '?type=f&w=30&h=40&faceopt=true&ttype=jpg'}">
<br>
<span id="userId" data-th-text="'회원번호 : ' + ${session.loginUser.no}"></span><br>
<span id="userName" data-th-text="'회원 : ' + ${session.loginUser.name}+님"></span><br>
<span id="email" data-th-text="'이메일 : ' + ${session.loginUser.email}"></span><br>


<!-- 포인트 충전 입력 필드 -->
<h2>포인트 충전</h2>
<input type="text" id="rechargeAmount" placeholder="충전할 포인트 입력" onkeyup="formatCurrency(this)">
<button id="rechargeButton">포인트 충전</button>

<!-- 결과 표시를 위한 엘리먼트 -->
<div id="result"></div>

<!-- 세션에서 사용자 포인트를 HTML에 포함 -->
<span id="userPoints" data-th-text="'보유포인트 : ' + ${session.loginUser.point}+원"></span>

<!-- 환전 요청 버튼 컨테이너 -->
<div class="request-button-container">
    <a href="/exchange/form" class="request-button">환전 요청</a>
</div>

<!-- "환전 내역" 버튼 -->
<button id="fetchData">환전 내역</button>

<!-- 환전 내역 테이블 -->
<div class="page-container">
    <table id="exchangeTable" style="display: none;"> <!-- id와 스타일 추가 -->
        <thead>
        <tr>
            <th>번호</th>
            <th>예금주</th>
            <th>은행</th>
            <th>계좌번호</th>
            <th>환전 금액</th> <!-- 환전 금액 칼럼 추가 -->
            <th>작성일</th>
        </tr>
        </thead>
        <tbody id="exchangeList">
        <!-- JavaScript에서 이 부분에 동적으로 데이터를 채워넣게 됩니다. -->
        </tbody>
    </table>
</div>

<!-- 환전내역 스크립트 -->
<script src="/js/exchangeAPI.js"></script>

<!-- "입찰 내역" 불러오기 -->

<div class="container mt-5">
    <button id="loadBidList" class="btn btn-primary mb-3">입찰 내역</button>
    <table class="table table-bordered table-striped" style="display: none;" id="bidTable">
        <thead>
        <tr>
            <th>번호</th>
            <th>작품명</th>
            <th>가격</th>
            <th>입찰 여부</th>
            <th>입찰일</th>
        </tr>
        </thead>
        <tbody id="bidListBody">
        </tbody>
    </table>
</div>


<!-- HTML 태그에 삽입 -->
<div id="userNo" data-th-text="${session.loginUser.no}" style="display: none;"></div>
<div id="userPoint" data-th-text="${session.loginUser.point}" style="display: none;"></div>

<!-- 입찰내역 스크립트 -->
<script src="/js/historyAPI.js" defer></script>

<!-- 포인트 충전 및 입찰 스크립트 -->
<script src="/js/chargeScript.js"></script>

<div data-th-replace="footer :: footer"></div>
</body>
</html>


